<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.loha.flippedclassroom.mapper.StrategyMapper">
    <resultMap id="teamStrategyMap" type="TeamStrategy">
        <result column="course_id" property="courseId"/>
        <result column="strategy_serial" property="strategySerial"/>
        <result column="strategy_id" property="strategyId"/>
        <result column="strategy_name" property="strategyTableName"/>
    </resultMap>

    <resultMap id="teamAndStrategyMap" type="StrategyInfo">
        <id column="id" property="id"/>
        <result column="strategy_name" property="strategyName"/>
        <result column="strategy_id" property="strategyId"/>
    </resultMap>

    <resultMap id="teamOrStrategyMap" type="StrategyInfo">
        <id column="id" property="id"/>
        <result column="strategy_name" property="strategyName"/>
        <result column="strategy_id" property="strategyId"/>
    </resultMap>

    <resultMap id="memberLimitStrategyMap" type="MemberLimitStrategy">
        <id column="id" property="id"/>
        <result column="min_member" property="minMember"/>
        <result column="max_member" property="maxMember"/>
    </resultMap>

    <resultMap id="courseMemberLimitStrategyMap" type="CourseMemberLimitStrategy">
        <id column="id" property="id"/>
        <result column="course_id" property="courseId"/>
        <result column="min_member" property="minMember"/>
        <result column="max_member" property="maxMember"/>
    </resultMap>

    <resultMap id="conflictCourseStrategyMap" type="ConflictCourseStrategy">
        <id column="id" property="id"/>
        <collection property="courseIds" ofType="Long" column="id" select="selectCourseIdsInConflict">
        </collection>
    </resultMap>




    <select id="selectTeamAndStrategyById" parameterType="Long" resultMap="teamAndStrategyMap">
        select * from team_and_strategy where id=#{value}
    </select>

    <select id="selectTeamOrStrategyById" parameterType="Long" resultMap="teamOrStrategyMap">
        select * from team_or_strategy where id=#{value}
    </select>

    <select id="selectMemberLimitStrategyById" parameterType="Long" resultMap="memberLimitStrategyMap">
        select * from member_limit_strategy where id=#{value}
    </select>

    <select id="selectCourseMemberLimitStrategyById" parameterType="Long" resultMap="courseMemberLimitStrategyMap">
        select * from course_member_limit_strategy where id=#{value}
    </select>
    
    
    
    <!--重新写-->
    <select id="selectConflictCourseId" parameterType="Long" resultType="Long">
        select course_id from conflict_course_strategy where id=#{value}
    </select>

    <select id="selectTeamAndStrategy" parameterType="Long" resultMap="teamAndStrategyMap">
        select * from team_and_strategy where id=#{value}
    </select>

    <select id="selectTeamOrStrategy" parameterType="Long" resultMap="teamOrStrategyMap">
        select * from team_or_strategy where id=#{value}
    </select>

    <select id="selectTeamStrategyByCourseId" parameterType="Long" resultMap="teamStrategyMap">
        select * from team_strategy where course_id=#{value} where strategy_serial=1
    </select>


</mapper>